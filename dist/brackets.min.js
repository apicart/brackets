/** 
 * brackets.js v1.0.0 
 * (c) 2018-2019 Vladimír Macháček
 *  Released under the MIT License.
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";function cloneObject(t){var r={};return Object.keys(t).forEach(function(e){r[e]=t&&typeof t===Object(t)?cloneObject(t[e]):t[e]}),r}function each(e,t){var r,n,a,o,c;if(Array.isArray(e))for(n=e.length,r=0;r<n&&!1!==t(r,e[r]);r++);else for(o=(a=Object.keys(e)).length,r=0;r<o&&!1!==t(c=a[r],e[c]);r++);}function generateHash(e){return e=e||10,e+=2,Math.random().toString(36).substring(2,e)}var Brackets={devMode:!1},templateLiteralsEnabled=function(){try{return eval("`x`"),!0}catch(e){return!1}}(),macrosRegularExpression,templateLiteral=templateLiteralsEnabled?"`":"'",components={register:{},renderToString:function(e,t){var r=components.register[e];if(void 0===r)throw new Error('Brackets: Component "'+e+'" was not found.');var n=generateHash(),a=r.data?cloneObject(r.data):{};t&&each(t,function(e,t){a[e]=t});var o=Brackets.renderToString({beforeRender:r.beforeRender,cacheKey:e,componentHash:n,data:a,template:r.template}),c=[{componentHash:n,data:a,componentName:e}].concat(o.templateRuntime.renderedComponents);return this.renderedComponents=this.renderedComponents.concat(c),o.templateString}},filters={},macros={breakif:"if (#0) break;",continueif:"if (#0) continue;",component:function(e){var t=e[0].split(","),r=t[0];return t.shift(),"_template += _runtime.components.renderToString.call(_runtime, '"+r+"', "+("{"+t.join(",")+"}")+");"},dump:"console.log(#0);",else:"} else {",elseif:"} else if (#0) {",for:"for (var #0) {","/for":"}",if:"if (#0) {","/if":"}",js:"#0;",var:"var #0;",while:"while (#0) {","/while":"}"};function generateMacrosRegularExpression(){macrosRegularExpression=new RegExp("{{(?:(?:("+Object.keys(macros).join("|").replace("/","/")+")(?: (.*?))?)|(?:(\\$.*?)))}}")}filters.escape=function(e){var t={'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#x2F;","<":"&lt;","=":"&#x3D;",">":"&gt;","`":"&#x60;"};return String(e).replace(/[&<>"'`=/]/g,function(e){return t[e]})},Brackets.addComponent=function(e,t){return components.register[e]=t,Brackets},Brackets.addFilter=function(e,t){return filters[e]=t,Brackets},Brackets.addMacro=function(e,t){return macros[e]=t,generateMacrosRegularExpression(),Brackets},generateMacrosRegularExpression(),Brackets._filters=filters,Brackets.templateLiteral=templateLiteral;var selectorAttributeName="data-brackets-component",tokenReplacement="}}{{",textRegularExpression=/{{((?:.|\n)*?)}}/;function tokenizeTemplate(e){var t,r,n,a=[],o=[];if(e){for(;t=macrosRegularExpression.exec(e);)r=[],n=t[0],t.shift(),each(t,function(e,t){isNaN(parseInt(e))||void 0!==t&&r.push(t)}),a.push(r),e=e.replace(n,tokenReplacement);for(e="{{"+e+"}}";t=textRegularExpression.exec(e);)o.push(t[1]),e=e.replace(t[0],"")}return{macros:a,text:o}}function processVariable(e){var r,n,a=!0,o=[],t=e[0].split("|"),c=t[0].replace("$","");return t.shift(),t.length&&each(t,function(e,t){if(r=t.split(":"),"noescape"!==(n=r[0])){if((o="string"==typeof r[1]?r[1].split(","):[]).unshift(c),void 0===filters[n])throw'Undefined filter: "'+n+'".';c="Brackets._filters."+n+"("+o.join(",")+")"}else a=!1}),a&&(c="Brackets._filters.escape("+c+")"),"_template += "+c+";"}function processMacro(e){var r,t=e[0];return e.shift(),"string"==typeof macros[t]?(r=macros[t],each(e,function(e,t){r=r.replace(new RegExp("#"+e),t)})):r=macros[t](e),r}var variableMatchRegularExpression=/^\$/;function compileTemplate(r,e){e=e||{};var n,a,o="var _template = '';";return each(r.text,function(e,t){if(o+="_template += "+templateLiteral+t+templateLiteral+";",e in r.macros)if(n=r.macros[e],(a=n[0]).match(variableMatchRegularExpression))o+=processVariable(n);else{if(!(a in macros))throw'Unknown token: "'+a+'"';o+=processMacro(n)}}),o+="return _template;",new Function(Object.keys(e).join(","),o)}var templatesCache={};function renderToString(e){"function"==typeof e.beforeRender&&e.beforeRender.call(e);var t,r=e.cacheKey||null,n="string"==typeof r,a=e.data?cloneObject(e.data):{},o=e.template||null,c=[];(a._runtime={components:components,renderedComponents:[]},n&&r in templatesCache)?t=templatesCache[r]:(templateLiteralsEnabled||(o=(o=o.replace(/(?:\r\n|\r|\n)/g," ")).replace(/'/g,"'")),t=compileTemplate(tokenizeTemplate(o),a),!n||r in templatesCache||(templatesCache[r]=t));a&&each(a,function(e,t){c.push(t)});var i=t.apply(null,c);if(e.componentHash){i=i.replace("b-on=","b-on-"+e.componentHash+"=");var s=(new DOMParser).parseFromString(i,"text/html").querySelector("body *");s&&(s.setAttribute(selectorAttributeName,e.componentHash),i=s.outerHTML)}return{templateString:i,templateRuntime:a._runtime}}var eventHandlerAttributeName="b-on";function attachEventHandlers(e,s){var t=s.componentHash?"-"+s.componentHash:"",n=eventHandlerAttributeName+t,r="["+n+"]";each(e.querySelectorAll(r),function(e,r){each(r.getAttribute(n).split(";"),function(e,t){!function(e,t){var r,n=(t=t.trim()).match(/^(\S+)/)[1],a=[];if((t=t.replace(n+" ","")).match(/\S+\(.*\)$/)){var o=t.match(/^([^(]+)\((.*)\)/),c=o[1],i=o[2];if(void 0===s.methods||void 0===s.methods[c])throw new Error('Brackets: Method "'+c+'" is not defined.');r=s.methods[c],a=[i]}else r=new Function("data","this."+t+"; return this;");e.addEventListener(n,function(e){if(!(r.apply(s.data,[e].concat(a))||!0))return!1;Brackets.render(s)})}(r,t)}),Brackets.devMode||r.removeAttribute(n)})}var nonInitializedElementAttributeName="b-init";function render(i){var e;if(i.data=i.data?cloneObject(i.data):{},i.methods=i.methods||{},i.beforeRender=i.beforeRender||function(){},i.afterRender=i.afterRender||function(){},"string"==typeof i.el)e=document.querySelectorAll(i.el);else if(i.el instanceof Element)e=[i.el];else{if(!(i.el instanceof NodeList||Array.isArray(i.el)))throw new Error("Brackets: unsupported type for parameter el.");e=i.el}e&&each(e,function(e,r){var t=r.getAttribute(selectorAttributeName),n=t?i:cloneObject(i);if(t||(t=generateHash(),r.setAttribute(selectorAttributeName,t),n.el="["+selectorAttributeName+'="'+t+'"]',n.hash=t),n.template){if(n.template&&n.template.match(/^#\S+/)){var a=document.querySelector(n.template);a&&(n.template=a.innerHTML)}}else n.template=r.innerHTML;n.beforeRender.call(n,r);var o=renderToString({componentHash:n.componentHash||null,cacheKey:n.cacheKey,data:n.data,template:n.template}),c=(new DOMParser).parseFromString(o.templateString,"text/html").querySelector(n.el);c&&(o.templateString=c.innerHTML),r.innerHTML=o.templateString,each(o.templateRuntime.renderedComponents,function(e,t){t.el="["+selectorAttributeName+'="'+t.componentHash+'"]',t.template=components.register[t.componentName].template,t.methods=components.register[t.componentName].methods,t.afterRender=components.register[t.componentName].afterRender,t.beforeRender=components.register[t.componentName].beforeRender,attachEventHandlers(r,t),"function"==typeof t.afterRender&&t.afterRender.call(t,r)}),attachEventHandlers(r,n),r.removeAttribute(nonInitializedElementAttributeName),n.afterRender.call(n,r)})}Brackets.render=render,Brackets.renderToString=renderToString,"undefined"!=typeof window&&void 0===window.Brackets?window.Brackets=Brackets:"object"==typeof module&&"object"==typeof module.exports&&(module.exports=Brackets)});
