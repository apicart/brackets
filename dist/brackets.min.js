/** 
 * brackets.js v1.0.0-alpha3 
 * (c) 2018-2019 Vladimír Macháček
 *  Released under the MIT License.
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";var utils={cloneObject:function(t){var n={};return Object.keys(t).forEach(function(e){n[e]=t&&typeof t===Object(t)?utils.cloneObject(t[e]):t[e]}),n},getElementsAsArray:function(e){var t=[];if("string"==typeof e)t=document.querySelectorAll(e);else if(e instanceof Element)t=[element];else{if(!(e instanceof NodeList||Array.isArray(e)))throw new Error("Brackets: unsupported type for parameter el.");t=e}if(1<t.length&&"undefined"!=typeof parameters&&parameters.cacheKey&&!parameters.template)throw new Error("Brackets: you must provide a single template for '"+parameters.cacheKey+"' cacheKey because multiple target elements were found.");return t},mergeObjects:function(){var n={},e=Array.prototype.slice.call(arguments);return utils.each(e,function(e,t){utils.each(t,function(e,t){n[e]=e in n&&utils.isObject(t)?utils.mergeObjects(n[e],t):t})}),n},isObject:function(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e},isFunction:function(e){return"function"==typeof e},each:function(e,t){var n,r,a,i,c,s={iterableLength:0,counter:0,isEven:function(){return this.counter%2==0},isOdd:function(){return 1===Math.abs(this.counter%2)},isFirst:function(){return 1===this.counter},isLast:function(){return this.counter===this.iterableLength}};if(!(-1<["undefined","number"].indexOf(typeof e)||null===e))if(Array.isArray(e)){if(!(r=Object.keys(e).length))return;for(s.iterableLength=r,n=0;n<r&&(s.counter++,!1!==t.apply(s,[n,e[n]]));n++);}else{if(i=(a=Object.keys(e)).length,!a.length)return;for(s.iterableLength=i,n=0;n<i&&(s.counter++,c=a[n],!1!==t.apply(s,[c,e[c]]));n++);}},generateHash:function(e){return e=e||10,e+=2,Math.random().toString(36).substring(2,e)}},macros={break:"break;",breakIf:"if (#0) break;",capture:function(e){return"var "+e+" = (function () {var _template = "+templateLiteral+templateLiteral+";"},"/capture":"return _template;})();",continue:"continue;",continueIf:"if (#0) continue;",component:function(e){var t=e[0].split(","),n=t[0];return t.shift(),"_template += _runtime.renderComponent('"+n+"', "+("{"+t.join(",")+"}")+");"},dump:"console.log(#0);",else:"} else {",elseif:"} else if (#0) {",for:"for (var #0) {","/for":"}",foreach:function(e){var t=(e=e[0].split("as"))[1].trim();return 1===e[1].split(",").length&&(t="key, "+t),"_runtime.utils.each("+e[0].trim()+", function ("+t+") {"},"/foreach":"});",first:"if (this->isFirst())","/first":"}",last:"if (this->isLast()){","/last":"}",sep:"if (!this->isLast()){","/sep":"}",if:"if (#0) {","/if":"}",js:"#0;",returnFalseIf:"if (#0) return false;",returnIf:"if (#0) return;",var:"var #0;",while:"while (#0) {","/while":"}"},openingDelimiter,closingDelimiter,macrosRegularExpression,openingDelimiter$1,closingDelimiter$1,tokenReplacement,textRegularExpression;function addMacro(e,t){if(e in macros)throw new Error('Brackets: Macro "'+e+'" is already defined.');return macros[e]=t,generateMacrosRegularExpression(),Brackets}function getMacros(){return macros}function generateMacrosRegularExpression(){macrosRegularExpression=new RegExp(openingDelimiter+" *(?:(?:("+Object.keys(macros).join("|").replace("/","/")+")(?: (.*?))?) *| *(?:(\\$.*?))) *"+closingDelimiter)}function initMacros(e){openingDelimiter=e.delimiters[0],closingDelimiter=e.delimiters[1],generateMacrosRegularExpression()}function tokenizeTemplate(e){var t,n,r,a=[],i=[];if(e){for(;t=macrosRegularExpression.exec(e);)n=[],r=t[0],t.shift(),utils.each(t,function(e,t){isNaN(parseInt(e))||void 0!==t&&n.push(t)}),a.push(n),e=e.replace(r,tokenReplacement);for(e=openingDelimiter$1+e+closingDelimiter$1;t=textRegularExpression.exec(e);)i.push(t[1]),e=e.replace(t[0],"")}return{macros:a,text:i}}function initTemplateTokenizer(e){openingDelimiter$1=e.delimiters[0],closingDelimiter$1=e.delimiters[1],textRegularExpression=new RegExp(openingDelimiter$1+"((?:.|\n)*?)"+closingDelimiter$1),tokenReplacement=closingDelimiter$1+openingDelimiter$1}var Brackets={config:{devMode:!1,delimiters:["{{","}}"]},configure:function(e){return e&&(this.config=utils.mergeObjects(this.config,e)),initTemplateTokenizer(this.config),initMacros(this.config),this}},eventHandlersAttributeName="b-on",nonInitializedElementAttributeName="b-init",selectorAttributeName="b-instance",templateLiteralsEnabled=function(){try{return eval("`x`"),!0}catch(e){return!1}}(),templateLiteral=templateLiteralsEnabled?"`":"'",cacheManager={cache:{}};function processVariable(e){var n,r,a=!0,i=[],t=e[0].split("|"),c=t[0].replace("$","");return t.shift(),t.length&&utils.each(t,function(e,t){n=t.split(":"),"noescape"!==(r=n[0]||null)?((i="string"==typeof n[1]?n[1].split(","):[]).unshift(c),c="_templateAdd(["+i+"], '"+r+"')"):a=!1}),a&&(c="_templateAdd("+c+")"),"_template += "+c+";"}function processMacro(e){var n,t=e[0],r=getMacros();return e.shift(),"string"==typeof r[t]?(n=r[t],utils.each(e,function(e,t){n=n.replace(new RegExp("#"+e),t)})):n=r[t](e),n}cacheManager.getCache=function(e,t){return cacheManager.hasCache(e,t)?cacheManager.cache[e][t]:null},cacheManager.setCache=function(e,t,n){return cacheManager.hasCacheRegion(e)||(cacheManager.cache[e]={}),cacheManager.hasCache(e,t)||(cacheManager.cache[e][t]=n),cacheManager},cacheManager.hasCacheRegion=function(e){return e in cacheManager.cache},cacheManager.hasCache=function(e,t){return!!cacheManager.hasCacheRegion(e)&&t in cacheManager.cache[e]};var variableMatchRegularExpression=/^\$/;function compileTemplate(n,e){var r,a,i="var _template = '';"+_templateAdd.toString()+";";return utils.each(n.text,function(e,t){if(i+="_template += _templateAdd("+templateLiteral+t+templateLiteral+");",e in n.macros)if(r=n.macros[e],(a=r[0]).match(variableMatchRegularExpression))i+=processVariable(r);else{if(!(a in getMacros()))throw'Unknown token: "'+a+'"';i+=processMacro(r)}}),i+="return _template;",new Function(e.join(","),i)}function _templateAdd(e,t){return _runtime.templateAdd(e,t)}var filters={};function addFilter(e,t){if(getFilter(e,!1))throw new Error('Brackets: Filter "'+e+'" is already defined.');return filters[e]=t,Brackets}function getFilter(e,t){if(!1!==t&&!(e in filters))throw new Error('Brackets: Filter "'+e+'" not found.');return filters[e]||null}function getFilters(){return filters}addFilter("escape",function(e){var t={'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#x2F;","<":"&lt;","=":"&#x3D;",">":"&gt;","`":"&#x60;"};return String(e).replace(/[&<>"'`=/]/g,function(e){return t[e]})});var TEMPLATE_FUNCTIONS_CACHE_REGION="templateFunctions",TEMPLATE_RESULTS_CACHE_REGION="templateResults";function renderTemplate(e,t){if(t.resultCacheEnabled&&t.hash&&cacheManager.hasCache(TEMPLATE_RESULTS_CACHE_REGION,t.hash))return cacheManager.getCache(TEMPLATE_RESULTS_CACHE_REGION,t.hash);var n="string"==typeof t.cacheKey,r=n?cacheManager.getCache(TEMPLATE_FUNCTIONS_CACHE_REGION,t.cacheKey):null,a=t.data,i={renderComponent:function(e,t){return getComponent(e).render(this,t)},renderTemplate:renderTemplate,getFilter:getFilter,renderedComponents:[],blocks:{},utils:utils,templateAdd:function(e,t){return void 0===e?"":(Array.isArray(e)||(e=[e]),(t=!0===(t=!1===t?null:t)?"escape":t)?this.getFilter(t).apply(null,e):e)}},c=[i];(utils.each(t.runtime,function(e,t){i[e]=t}),r)||(templateLiteralsEnabled||(e=(e=e.replace(/(?:\r\n|\r|\n)/g," ")).replace(/'/g,"'")),r=compileTemplate(tokenizeTemplate(e),["_runtime"].concat(Object.keys(a))),n&&cacheManager.setCache(TEMPLATE_FUNCTIONS_CACHE_REGION,t.cacheKey,r));utils.each(a,function(e,t){c.push(t)});var s=r.apply(null,c);if(s=s.replace(new RegExp(eventHandlersAttributeName+"=","g"),t.hash?eventHandlersAttributeName+"-"+t.hash+"=":eventHandlersAttributeName+"="),"component"===t.type){var o=(new DOMParser).parseFromString(s,"text/html").querySelector("body *");o&&(o.setAttribute(selectorAttributeName,t.id),s=o.outerHTML)}return t.resultCacheEnabled&&cacheManager.setCache(TEMPLATE_RESULTS_CACHE_REGION,t.hash,{templateString:s,templateRuntime:i}),{templateString:s,templateRuntime:i}}function renderToString(e){return renderTemplate(e.template,{cacheKey:e.cacheKey,data:e._data,id:e.instanceId,hash:e.hash,type:e.type,resultCacheEnabled:e.resultCacheEnabled,runtime:{parentInstance:e}})}var components={register:{}};function addComponent(e,t){if(getComponent(e,!1))throw new Error('Brackets: Component "'+e+'" is already defined.');return t.type="component",components.register[e]=t,Brackets}function getComponent(e,t){if(e in components.register)return createRenderingInstanceObject(utils.cloneObject(components.register[e]));if(!1!==t)throw new Error('Brackets: Component "'+e+'" not found.');return null}function renderComponent(e,n,t){t&&utils.each(t,function(e,t){n.addData(e,t)}),n.parentInstanceId=e.parentInstance.instanceId,n.isMounted||n.beforeMount();var r=renderToString(n);return n.childrenInstancesIds=r.templateRuntime.renderedComponents,e.renderedComponents=e.renderedComponents.concat([n.instanceId]),r.templateString}function getComponents(){return components}var renderingInstances={};function bindEventHandlers(l){if(l.el){var r=eventHandlersAttributeName+"-"+l.hash,e="["+r+"]",n=[];utils.each(l.el.querySelectorAll(e),function(e,t){n.push(t)}),l.el.getAttribute(r)&&n.push(l.el),utils.each(n,function(e,n){var t=n.getAttribute(r).split(";");utils.each(t,function(e,t){!function(e,t){var n=(t=t.trim()).match(/^(\S+)/);if(n&&void 0!==n[1]){var r,a=n[1],i=[];if((t=t.replace(a+" ","")).match(/\S+\(.*\)$/)){var c=t.match(/^([^(]+)\((.*)\)/),s=c[1],o=c[2];if(!l.methods[s])throw new Error('Brackets: Method "'+s+'" is not defined.');r=l.methods[s],i=[o]}else r=new Function("data","this.data."+t+"; return this;");e.addEventListener(a,function(e){r.apply(l,[e].concat(i))})}}(n,t)}),Brackets.config.devMode||n.removeAttribute(r)})}}function bindPropertyDescriptors(r){r._propertyDescriptorsInitialized||(r._data=utils.cloneObject(r.data),r.data={},r._propertyDescriptorsInitialized=!0),utils.each(r._data,function(n){n in r.data||Object.defineProperty(r.data,n,{get:function(){return r._data[n]},set:function(e){var t=r._data[n];r._data[n]=e,n in r.watch&&r.watch[n].call(r,e,t),r.redrawingEnabled&&(r.redrawingEnabled=!1,r.redraw(),r.redrawingEnabled=!0)}})})}function createRenderingInstanceObject(e,t){"function"==typeof(e=utils.cloneObject(e)).template&&(e.template=e.template.call(e));var n={childrenInstancesIds:[],cacheKey:e.cacheKey||null,data:e.data?utils.cloneObject(e.data):{},hash:utils.generateHash(),isMounted:!1,methods:{},parentInstanceId:null,redrawingEnabled:!1,resultCacheEnabled:e.resultCacheEnabled||!1,type:e.type||"view",template:e.template,watch:e.watch||{},_data:{},_instanceId:null,_dataObjectInitialized:!1,set instanceId(e){this._instanceId=e},get instanceId(){return this._instanceId?this._instanceId+"-"+this.hash:this.hash},get parentInstance(){return getRenderingInstance(this.parentInstanceId)},addData:function(e,t){return this._data[e]=t,bindPropertyDescriptors(this),this},destroy:function(){return this.beforeDestroy(),destroyChildrenInstances(this),delete renderingInstances[this.instanceId],this.destroyed(),this},redraw:function(){return renderInstance(this),this},beforeCreate:function(){return utils.isFunction(e.beforeCreate)&&e.beforeCreate.call(this),this},created:function(){return utils.isFunction(e.created)&&e.created.call(this),this},beforeMount:function(){return utils.isFunction(e.beforeMount)&&e.beforeMount.call(this),this},mounted:function(){return utils.isFunction(e.mounted)&&e.mounted.call(this),n.isMounted=!0,n.redrawingEnabled=!0,this},beforeUpdate:function(){return utils.isFunction(e.beforeUpdate)&&e.beforeUpdate.call(this),this},updated:function(){return utils.isFunction(e.updated)&&e.updated.call(this),this},beforeDestroy:function(){return utils.isFunction(e.beforeDestroye)&&e.beforeDestroy.call(this),this},destroyed:function(){return utils.isFunction(e.destroyed)&&e.destroyed.call(this),this}};if(n.instanceId=e.instanceId||null,n.el=t||null,"view"===n.type?n.render=function(){return renderInstance(this)}:n.render=function(e,t){return renderComponent(e,this,t)},t&&t instanceof Element&&!t.getAttribute(selectorAttributeName)&&t.setAttribute(selectorAttributeName,n.instanceId),!e.template&&t)n.template=t.outerHTML;else if(e.template&&e.template.match(/^#\S+/)){var r=document.querySelector(e.template);r&&(n.template=r.innerHTML)}else if(!e.template&&!t)throw new Error("Brackets: No template or target element provided for rendering.");if(utils.each(e.methods||{},function(e,t){n.methods[e]=t}),n.beforeCreate(),bindPropertyDescriptors(n),getRenderingInstance(n.instanceId,!1))throw new Error('Brackets: Rendering instance "'+n.instanceId+'" is already defined.');return(renderingInstances[n.instanceId]=n).created(),n}function destroyChildrenInstances(e){utils.each(e.childrenInstancesIds,function(e,t){var n=getRenderingInstance(t,!1);n&&n.destroy()}),e.childrenInstancesIds=[]}function findRenderingInstance(e){var t=findRenderingInstances(e),n=Object.keys(t);return n.length?t[n[0]]:null}function getRenderingInstance(e,t){if(null===e)return null;if(!1!==t&&!(e in renderingInstances))throw new Error('Brackets: Rendering instance "'+e+'" not found.');return renderingInstances[e]||null}function findRenderingInstances(n){var r={};return utils.each(renderingInstances,function(e,t){e.includes(n)&&(r[e]=t)}),r}function getRenderingInstances(n){if(!n)return renderingInstances;var r={};return utils.each(renderingInstances,function(e,t){t.type===n&&(r[e]=t)}),r}function mountInstance(e){e.mounted(),utils.each(e.childrenInstancesIds,function(e,t){mountInstance(getRenderingInstance(t))})}function prepareInstanceForRendering(r){var e=r.el instanceof Element;e&&bindEventHandlers(r),e&&!Brackets.config.devMode&&(r.el.removeAttribute(nonInitializedElementAttributeName),r.el.removeAttribute("b-instance")),utils.each(r.childrenInstancesIds,function(e,t){var n=getRenderingInstance(t);n.el=r.el.querySelector('[b-instance="'+t+'"]'),prepareInstanceForRendering(n)})}function renderInstance(e){destroyChildrenInstances(e),e.isMounted?e.beforeUpdate():e.beforeMount();var t=renderToString(e),n=(new DOMParser).parseFromString(t.templateString,"text/html"),r=n.body.firstChild,a=r instanceof Element?r:n.body.innerHTML,i=e.el;return e.childrenInstancesIds=t.templateRuntime.renderedComponents,e.el=a,prepareInstanceForRendering(e),a instanceof Element?i.parentElement.replaceChild(e.el,i):i.innerHTML=e.el,e.isMounted?e.updated():mountInstance(e),e}function render(n){var e=utils.getElementsAsArray(n.el);if(e){var r=[];return utils.each(e,function(e,t){r.push(createRenderingInstanceObject(n,t).render())}),r}}Brackets.utils=utils,Brackets.cacheManager=cacheManager,Brackets.templateLiteral=templateLiteral,Brackets.addFilter=addFilter,Brackets.getFilter=getFilter,Brackets.getFilters=getFilters,Brackets.addComponent=addComponent,Brackets.getComponent=getComponent,Brackets.getComponents=getComponents,Brackets.addMacro=addMacro,Brackets.getMacros=getMacros,Brackets.findRenderingInstance=findRenderingInstance,Brackets.getRenderingInstance=getRenderingInstance,Brackets.findRenderingInstances=findRenderingInstances,Brackets.getRenderingInstances=getRenderingInstances,Brackets.render=render,Brackets.renderTemplate=renderTemplate,Brackets.renderToString=function(e){return renderToString(createRenderingInstanceObject(e))},Brackets.configure(),"undefined"!=typeof window&&void 0===window.Brackets?window.Brackets=Brackets:"object"==typeof module&&"object"==typeof module.exports&&(module.exports=Brackets)});
